# 2026-01-05 連線大廳系統設計

## 背景
多人連線貪食蛇遊戲原本是連線後立即開始遊戲，但缺乏玩家等待和協調機制，需要加入大廳功能讓玩家可以在遊戲開始前準備。

## 選項
1. **簡單自動開始**：連線後自動開始，沒有準備機制
2. **準備機制 + 自動開始**：玩家可以準備，所有人準備好後自動開始
3. **房主完全控制**：只有房主可以決定何時開始
4. **混合模式**：結合準備機制和房主控制（採用）

## 決定
採用混合模式：
- 玩家可以點擊「準備」按鈕表示準備狀態
- 當所有玩家都準備好且至少 2 人時，3 秒後自動開始
- 房主（第一個進入的玩家）可以強制開始遊戲（需至少 1 人）
- 房主離開時自動轉移給下一位玩家
- 遊戲結束後返回大廳而非直接斷線

## 原因
1. **彈性**：同時支援等待所有人和快速開始兩種模式
2. **使用者體驗**：準備機制讓玩家有時間調整，房主控制提供便利性
3. **可重複遊玩**：返回大廳機制避免每次都要重新連線
4. **公平性**：自動轉移房主確保遊戲可以持續進行

## 技術實作
- 伺服器端使用 `gameState` 管理大廳和遊戲兩種狀態
- WebSocket 訊息類型：`ready`、`startGame`、`lobbyUpdate`、`gameStart`、`gameEnd`
- 客戶端使用 CSS class 切換大廳和遊戲介面
